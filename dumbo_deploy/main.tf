#create RDS instance
resource "aws_db_instance" "dumbo-tf" {
 identifier           = "${var.config["environment_identifier"]}"
 allocated_storage    = 100
 storage_type         = "gp2"
 engine               = "postgres"
 engine_version       = "9.6.6"
 instance_class       = "${var.config["instance_class"]}"
 #name                 = "mydb"
 username             = "${var.config["secret_dumbo_user"]}"
 password             = "${var.config["secret_dumbo_db_pass"]}"
 db_subnet_group_name = "bbapp-productiontovpc-systemdbsubnetgroup-51xsxgq84k6h"
 vpc_security_group_ids = "rds-default-vpc-fd861098-1tuj"
 parameter_group_name = "default.postgres9.6"
}
# Create a new endpoints
resource "aws_dms_endpoint" "postgres" {
  #certificate_arn             = "arn:aws:acm:us-east-1:123456789012:certificate/12345678-1234-1234-1234-123456789012"
  database_name               = "tf-postgres"
  endpoint_id                 = "aurora-postgres-tf"
  endpoint_type               = "target"
  engine_name                 = "aurora-postgresql"
  extra_connection_attributes = "ReplaceChars=ED,69"
  password                    = "${var.config["secret_dumbo_db_pass"]}"
  port                        = 5432
  server_name                 = "${aws_db_instance.dumbo-tf.identifier}"
  ssl_mode                    = "none"
  storage_encrypted           = true

  tags {
    Name = "test"
  }
  username = "${var.config["secret_dumbo_user"]}"
}
resource "aws_dms_endpoint" "buffalo" {
  #certificate_arn             = "arn:aws:acm:us-east-1:123456789012:certificate/12345678-1234-1234-1234-123456789012"
  database_name               = "tf-buffalo"
  endpoint_id                 = "dumbo-buffalo-tf"
  endpoint_type               = "source"
  engine_name                 = "oracle"
  password                    = "${var.config["secret_dumbo_db_pass"]}"
  port                        = 3306
  server_name                 = "${aws_db_instance.dumbo-tf.identifier}"
  ssl_mode                    = "none"

  tags {
    Name = "test"
  }
  username = "${var.config["secret_dumbo_user"]}"
}
resource "aws_dms_endpoint" "coyote" {
  #certificate_arn             = "arn:aws:acm:us-east-1:123456789012:certificate/12345678-1234-1234-1234-123456789012"
  database_name               = "tf-coyote"
  endpoint_id                 = "dumbo-coyote-tf"
  endpoint_type               = "source"
  engine_name                 = "oracle"
  password                    = "${var.config["secret_dumbo_db_pass"]}"
  port                        = 3306
  server_name                 = "${aws_db_instance.dumbo-tf.identifier}"
  ssl_mode                    = "none"

  tags {
    Name = "test"
  }
  username = "${var.config["secret_dumbo_user"]}"
}
resource "aws_dms_endpoint" "system" {
  #certificate_arn             = "arn:aws:acm:us-east-1:123456789012:certificate/12345678-1234-1234-1234-123456789012"
  database_name               = "tf-system"
  endpoint_id                 = "dumbo-system-tf"
  endpoint_type               = "source"
  engine_name                 = "oracle"
extra_connection_attributes = "afterConnectScript=ALTER SESSION SET NLS_LENGTH_SEMANTICS=char"
  password                    = "${var.config["secret_dumbo_db_pass"]}"
  port                        = 3306
  server_name                 = "${aws_db_instance.dumbo-tf.identifier}"
  ssl_mode                    = "none"


  tags {
    Name = "test"
  }
  username = "${var.config["secret_dumbo_user"]}"
}
# Create a new replication instance
#{aws_dms_replication_subnet_group.test-dms-replication-subnet-group-tf}
resource "aws_dms_replication_instance" "oracle-migration" {
  allocated_storage            = 50
  apply_immediately            = true
  auto_minor_version_upgrade   = true
  availability_zone            = "us-east-1c"
  engine_version               = "2.4.1"
  multi_az                     = false
  preferred_maintenance_window = "sat:03:01-sat:03:31"
  publicly_accessible          = true
  replication_instance_class   = "dms.t2.micro"
  replication_instance_id      = "oracle-migration-tf"
  replication_subnet_group_id  = "default-vpc-fd861098"

  tags {
    Name = "test"
  }

  vpc_security_group_ids = [
    "sg-b5ab38d2",
  ]
}
# Create a new replication task
resource "aws_dms_replication_task" "buffalo" {
  #cdc_start_time            = 1484346880
  migration_type            = "full-load-and-cdc"
  replication_instance_arn  = "${aws_dms_replication_instance.oracle-migration.replication_instance_arn}"
  replication_task_id       = "buffalo-task-tf"
  replication_task_settings = "{\r\n  \"TargetMetadata\": {\r\n    \"TargetSchema\": \"\",\r\n    \"SupportLobs\": true,\r\n    \"FullLobMode\": true,\r\n    \"LobChunkSize\": 64,\r\n    \"LimitedSizeLobMode\": false,\r\n    \"LobMaxSize\": 0,\r\n    \"LoadMaxFileSize\": 0,\r\n    \"ParallelLoadThreads\": 0,\r\n    \"ParallelLoadBufferSize\": 0,\r\n    \"BatchApplyEnabled\": false\r\n  },\r\n  \"FullLoadSettings\": {\r\n    \"TargetTablePrepMode\": \"DO_NOTHING\",\r\n    \"CreatePkAfterFullLoad\": false,\r\n    \"StopTaskCachedChangesApplied\": false,\r\n    \"StopTaskCachedChangesNotApplied\": false,\r\n    \"MaxFullLoadSubTasks\": 8,\r\n    \"TransactionConsistencyTimeout\": 600,\r\n    \"CommitRate\": 10000\r\n  },\r\n  \"Logging\": {\r\n    \"EnableLogging\": true,\r\n    \"LogComponents\": [\r\n      {\r\n        \"Id\": \"SOURCE_UNLOAD\",\r\n        \"Severity\": \"LOGGER_SEVERITY_DEFAULT\"\r\n      },\r\n      {\r\n        \"Id\": \"SOURCE_CAPTURE\",\r\n        \"Severity\": \"LOGGER_SEVERITY_DEFAULT\"\r\n      },\r\n      {\r\n        \"Id\": \"TARGET_LOAD\",\r\n        \"Severity\": \"LOGGER_SEVERITY_DEFAULT\"\r\n      },\r\n      {\r\n        \"Id\": \"TARGET_APPLY\",\r\n        \"Severity\": \"LOGGER_SEVERITY_DEFAULT\"\r\n      },\r\n      {\r\n        \"Id\": \"TASK_MANAGER\",\r\n        \"Severity\": \"LOGGER_SEVERITY_DEFAULT\"\r\n      }\r\n    ],\r\n    \"CloudWatchLogGroup\": \"dms-tasks-oracle-migration-test\",\r\n    \"CloudWatchLogStream\": \"dms-task-3KLOSCOSZ6TFDHDAF5G5KG4UBQ\"\r\n  },\r\n  \"ControlTablesSettings\": {\r\n    \"historyTimeslotInMinutes\": 5,\r\n    \"ControlSchema\": \"\",\r\n    \"HistoryTimeslotInMinutes\": 5,\r\n    \"HistoryTableEnabled\": false,\r\n    \"SuspendedTablesTableEnabled\": false,\r\n    \"StatusTableEnabled\": false\r\n  },\r\n  \"StreamBufferSettings\": {\r\n    \"StreamBufferCount\": 3,\r\n    \"StreamBufferSizeInMB\": 8,\r\n    \"CtrlStreamBufferSizeInMB\": 5\r\n  },\r\n  \"ChangeProcessingDdlHandlingPolicy\": {\r\n    \"HandleSourceTableDropped\": true,\r\n    \"HandleSourceTableTruncated\": true,\r\n    \"HandleSourceTableAltered\": true\r\n  },\r\n  \"ErrorBehavior\": {\r\n    \"DataErrorPolicy\": \"LOG_ERROR\",\r\n    \"DataTruncationErrorPolicy\": \"LOG_ERROR\",\r\n    \"DataErrorEscalationPolicy\": \"SUSPEND_TABLE\",\r\n    \"DataErrorEscalationCount\": 0,\r\n    \"TableErrorPolicy\": \"SUSPEND_TABLE\",\r\n    \"TableErrorEscalationPolicy\": \"STOP_TASK\",\r\n    \"TableErrorEscalationCount\": 0,\r\n    \"RecoverableErrorCount\": -1,\r\n    \"RecoverableErrorInterval\": 5,\r\n    \"RecoverableErrorThrottling\": true,\r\n    \"RecoverableErrorThrottlingMax\": 1800,\r\n    \"ApplyErrorDeletePolicy\": \"IGNORE_RECORD\",\r\n    \"ApplyErrorInsertPolicy\": \"LOG_ERROR\",\r\n    \"ApplyErrorUpdatePolicy\": \"LOG_ERROR\",\r\n    \"ApplyErrorEscalationPolicy\": \"LOG_ERROR\",\r\n    \"ApplyErrorEscalationCount\": 0,\r\n    \"ApplyErrorFailOnTruncationDdl\": false,\r\n    \"FullLoadIgnoreConflicts\": true,\r\n    \"FailOnTransactionConsistencyBreached\": false,\r\n    \"FailOnNoTablesCaptured\": false\r\n  },\r\n  \"ChangeProcessingTuning\": {\r\n    \"BatchApplyPreserveTransaction\": true,\r\n    \"BatchApplyTimeoutMin\": 1,\r\n    \"BatchApplyTimeoutMax\": 30,\r\n    \"BatchApplyMemoryLimit\": 500,\r\n    \"BatchSplitSize\": 0,\r\n    \"MinTransactionSize\": 1000,\r\n    \"CommitTimeout\": 1,\r\n    \"MemoryLimitTotal\": 1024,\r\n    \"MemoryKeepTime\": 60,\r\n    \"StatementCacheSize\": 50\r\n  }\r\n}"
  source_endpoint_arn       = "${aws_dms_endpoint.buffalo.endpoint_arn}"
  table_mappings            = "{\r\n \"rules\": [\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"1\",\r\n   \"rule-name\": \"1\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"BOUNCE_LOG\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"2\",\r\n   \"rule-name\": \"2\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"CONTACT_FIELD_OPTIONS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"3\",\r\n   \"rule-name\": \"3\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"CONTACT_FIELD_VALUES\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"4\",\r\n   \"rule-name\": \"4\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"CONTACT_FIELDS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"5\",\r\n   \"rule-name\": \"5\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"CONTACT_RELATIONSHIP_EVENTS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"6\",\r\n   \"rule-name\": \"6\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"CONTACTS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"7\",\r\n   \"rule-name\": \"7\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"CONTACTS_LIST\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"8\",\r\n   \"rule-name\": \"8\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"DRIP\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"9\",\r\n   \"rule-name\": \"9\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"DRIP_CONTACT_OR_LIST\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"10\",\r\n   \"rule-name\": \"10\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"DRIP_DROP\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"11\",\r\n   \"rule-name\": \"11\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"DRIP_DROP_JOB\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"12\",\r\n   \"rule-name\": \"12\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"DRIP_LIST_INTEGRATION\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"13\",\r\n   \"rule-name\": \"13\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"DRIP_PAUSE\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"14\",\r\n   \"rule-name\": \"14\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"EMAIL_JOBS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"15\",\r\n   \"rule-name\": \"15\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"EMAILS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"16\",\r\n   \"rule-name\": \"16\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"FEEDBACKLOOP\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"17\",\r\n   \"rule-name\": \"17\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"FORM_FIELDS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"18\",\r\n   \"rule-name\": \"18\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"FORM_SUBMISSION\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"19\",\r\n   \"rule-name\": \"19\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"FORMS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"20\",\r\n   \"rule-name\": \"20\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"HOSTED_DOC\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"21\",\r\n   \"rule-name\": \"21\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"IMAGES\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"22\",\r\n   \"rule-name\": \"22\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"JOB_CONTACT_INTERACTION\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"23\",\r\n   \"rule-name\": \"23\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"JOB_CONTACTS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"24\",\r\n   \"rule-name\": \"24\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"JOB_EMAIL_URL_CONTACTS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"25\",\r\n   \"rule-name\": \"25\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"JOB_EMAIL_URLS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"26\",\r\n   \"rule-name\": \"26\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"JOB_EMAILS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"27\",\r\n   \"rule-name\": \"27\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"JOB_VIDEOS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"28\",\r\n   \"rule-name\": \"28\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"JOBS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"29\",\r\n   \"rule-name\": \"29\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"LIST_UPLOAD\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"30\",\r\n   \"rule-name\": \"30\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"LIST_UPLOAD_STATUS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"31\",\r\n   \"rule-name\": \"31\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"LISTS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"32\",\r\n   \"rule-name\": \"32\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"PROMPT_BOT\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"33\",\r\n   \"rule-name\": \"33\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"SOCIAL_CONTENT\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"34\",\r\n   \"rule-name\": \"34\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"TAG\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"35\",\r\n   \"rule-name\": \"35\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"TAGGING\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"36\",\r\n   \"rule-name\": \"36\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"UNSUB_SURVEY\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"37\",\r\n   \"rule-name\": \"37\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"USER_ACTIVITY\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"38\",\r\n   \"rule-name\": \"38\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"USER_SCORE_HISTORY\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"39\",\r\n   \"rule-name\": \"39\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"VIDEO_EMAIL_PROMPT\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"40\",\r\n   \"rule-name\": \"40\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"VIDEO_FORMATS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"41\",\r\n   \"rule-name\": \"41\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"VIDEO_VIEW\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"42\",\r\n   \"rule-name\": \"42\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\",\r\n    \"table-name\": \"VIDEOS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"transformation\",\r\n   \"rule-id\": \"43\",\r\n   \"rule-name\": \"43\",\r\n   \"rule-target\": \"table\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"%\",\r\n    \"table-name\": \"%\"\r\n   },\r\n   \"rule-action\": \"convert-lowercase\"\r\n  },\r\n  {\r\n   \"rule-type\": \"transformation\",\r\n   \"rule-id\": \"44\",\r\n   \"rule-name\": \"44\",\r\n   \"rule-target\": \"column\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"%\",\r\n    \"table-name\": \"%\",\r\n    \"column-name\": \"%\"\r\n   },\r\n   \"rule-action\": \"convert-lowercase\"\r\n  },\r\n  {\r\n   \"rule-type\": \"transformation\",\r\n   \"rule-id\": \"45\",\r\n   \"rule-name\": \"45\",\r\n   \"rule-target\": \"schema\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"BB_USER\"\r\n   },\r\n   \"rule-action\": \"rename\",\r\n   \"value\": \"PROD\"\r\n  }\r\n ]\r\n}"

  tags {
    Name = "test"
  }
  target_endpoint_arn = "${aws_dms_endpoint.chartest.endpoint_arn}"
}
resource "aws_dms_replication_task" "coyote" {
  #cdc_start_time            = 1484346880
  migration_type            = "full-load-and-cdc"
  replication_instance_arn  = "${aws_dms_replication_instance.oracle-migration.replication_instance_arn}"
  replication_task_id       = "coyote-task-tf"
  replication_task_settings = "{\r\n  \"TargetMetadata\": {\r\n    \"TargetSchema\": \"\",\r\n    \"SupportLobs\": true,\r\n    \"FullLobMode\": true,\r\n    \"LobChunkSize\": 64,\r\n    \"LimitedSizeLobMode\": false,\r\n    \"LobMaxSize\": 0,\r\n    \"LoadMaxFileSize\": 0,\r\n    \"ParallelLoadThreads\": 0,\r\n    \"ParallelLoadBufferSize\": 0,\r\n    \"BatchApplyEnabled\": false\r\n  },\r\n  \"FullLoadSettings\": {\r\n    \"TargetTablePrepMode\": \"DO_NOTHING\",\r\n    \"CreatePkAfterFullLoad\": false,\r\n    \"StopTaskCachedChangesApplied\": false,\r\n    \"StopTaskCachedChangesNotApplied\": false,\r\n    \"MaxFullLoadSubTasks\": 8,\r\n    \"TransactionConsistencyTimeout\": 600,\r\n    \"CommitRate\": 10000\r\n  },\r\n  \"Logging\": {\r\n    \"EnableLogging\": true,\r\n    \"LogComponents\": [\r\n      {\r\n        \"Id\": \"SOURCE_UNLOAD\",\r\n        \"Severity\": \"LOGGER_SEVERITY_DEFAULT\"\r\n      },\r\n      {\r\n        \"Id\": \"SOURCE_CAPTURE\",\r\n        \"Severity\": \"LOGGER_SEVERITY_DEFAULT\"\r\n      },\r\n      {\r\n        \"Id\": \"TARGET_LOAD\",\r\n        \"Severity\": \"LOGGER_SEVERITY_DEFAULT\"\r\n      },\r\n      {\r\n        \"Id\": \"TARGET_APPLY\",\r\n        \"Severity\": \"LOGGER_SEVERITY_DEFAULT\"\r\n      },\r\n      {\r\n        \"Id\": \"TASK_MANAGER\",\r\n        \"Severity\": \"LOGGER_SEVERITY_DEFAULT\"\r\n      }\r\n    ],\r\n    \"CloudWatchLogGroup\": \"dms-tasks-oracle-migration-test\",\r\n    \"CloudWatchLogStream\": \"dms-task-B7TJ77EOMVINHLKPXDTLOEVHCU\"\r\n  },\r\n  \"ControlTablesSettings\": {\r\n    \"historyTimeslotInMinutes\": 5,\r\n    \"ControlSchema\": \"\",\r\n    \"HistoryTimeslotInMinutes\": 5,\r\n    \"HistoryTableEnabled\": false,\r\n    \"SuspendedTablesTableEnabled\": false,\r\n    \"StatusTableEnabled\": false\r\n  },\r\n  \"StreamBufferSettings\": {\r\n    \"StreamBufferCount\": 3,\r\n    \"StreamBufferSizeInMB\": 8,\r\n    \"CtrlStreamBufferSizeInMB\": 5\r\n  },\r\n  \"ChangeProcessingDdlHandlingPolicy\": {\r\n    \"HandleSourceTableDropped\": true,\r\n    \"HandleSourceTableTruncated\": true,\r\n    \"HandleSourceTableAltered\": true\r\n  },\r\n  \"ErrorBehavior\": {\r\n    \"DataErrorPolicy\": \"LOG_ERROR\",\r\n    \"DataTruncationErrorPolicy\": \"LOG_ERROR\",\r\n    \"DataErrorEscalationPolicy\": \"SUSPEND_TABLE\",\r\n    \"DataErrorEscalationCount\": 0,\r\n    \"TableErrorPolicy\": \"SUSPEND_TABLE\",\r\n    \"TableErrorEscalationPolicy\": \"STOP_TASK\",\r\n    \"TableErrorEscalationCount\": 0,\r\n    \"RecoverableErrorCount\": -1,\r\n    \"RecoverableErrorInterval\": 5,\r\n    \"RecoverableErrorThrottling\": true,\r\n    \"RecoverableErrorThrottlingMax\": 1800,\r\n    \"ApplyErrorDeletePolicy\": \"IGNORE_RECORD\",\r\n    \"ApplyErrorInsertPolicy\": \"LOG_ERROR\",\r\n    \"ApplyErrorUpdatePolicy\": \"LOG_ERROR\",\r\n    \"ApplyErrorEscalationPolicy\": \"LOG_ERROR\",\r\n    \"ApplyErrorEscalationCount\": 0,\r\n    \"ApplyErrorFailOnTruncationDdl\": false,\r\n    \"FullLoadIgnoreConflicts\": true,\r\n    \"FailOnTransactionConsistencyBreached\": false,\r\n    \"FailOnNoTablesCaptured\": false\r\n  },\r\n  \"ChangeProcessingTuning\": {\r\n    \"BatchApplyPreserveTransaction\": true,\r\n    \"BatchApplyTimeoutMin\": 1,\r\n    \"BatchApplyTimeoutMax\": 30,\r\n    \"BatchApplyMemoryLimit\": 500,\r\n    \"BatchSplitSize\": 0,\r\n    \"MinTransactionSize\": 1000,\r\n    \"CommitTimeout\": 1,\r\n    \"MemoryLimitTotal\": 1024,\r\n    \"MemoryKeepTime\": 60,\r\n    \"StatementCacheSize\": 50\r\n  }\r\n}"
  source_endpoint_arn       = "${aws_dms_endpoint.coyote.endpoint_arn}"
  table_mappings            = "{\r\n \"rules\": [\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"1\",\r\n   \"rule-name\": \"1\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"BOUNCE_LOG\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"2\",\r\n   \"rule-name\": \"2\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"CONTACT_FIELD_OPTIONS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"3\",\r\n   \"rule-name\": \"3\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"CONTACT_FIELD_VALUES\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"4\",\r\n   \"rule-name\": \"4\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"CONTACT_FIELDS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"5\",\r\n   \"rule-name\": \"5\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"CONTACT_RELATIONSHIP_EVENTS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"6\",\r\n   \"rule-name\": \"6\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"CONTACTS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"7\",\r\n   \"rule-name\": \"7\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"CONTACTS_LIST\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"8\",\r\n   \"rule-name\": \"8\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"DRIP\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"9\",\r\n   \"rule-name\": \"9\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"DRIP_CONTACT_OR_LIST\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"10\",\r\n   \"rule-name\": \"10\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"DRIP_DROP\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"11\",\r\n   \"rule-name\": \"11\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"DRIP_DROP_JOB\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"12\",\r\n   \"rule-name\": \"12\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"DRIP_LIST_INTEGRATION\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"13\",\r\n   \"rule-name\": \"13\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"DRIP_PAUSE\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"14\",\r\n   \"rule-name\": \"14\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"EMAIL_JOBS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"15\",\r\n   \"rule-name\": \"15\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"EMAILS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"16\",\r\n   \"rule-name\": \"16\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"FEEDBACKLOOP\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"17\",\r\n   \"rule-name\": \"17\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"FORM_FIELDS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"18\",\r\n   \"rule-name\": \"18\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"FORM_SUBMISSION\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"19\",\r\n   \"rule-name\": \"19\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"FORMS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"20\",\r\n   \"rule-name\": \"20\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"HOSTED_DOC\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"21\",\r\n   \"rule-name\": \"21\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"IMAGES\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"22\",\r\n   \"rule-name\": \"22\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"JOB_CONTACT_INTERACTION\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"23\",\r\n   \"rule-name\": \"23\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"JOB_CONTACTS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"24\",\r\n   \"rule-name\": \"24\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"JOB_EMAIL_URL_CONTACTS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"25\",\r\n   \"rule-name\": \"25\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"JOB_EMAIL_URLS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"26\",\r\n   \"rule-name\": \"26\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"JOB_EMAILS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"27\",\r\n   \"rule-name\": \"27\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"JOB_VIDEOS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"28\",\r\n   \"rule-name\": \"28\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"JOBS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"29\",\r\n   \"rule-name\": \"29\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"LIST_UPLOAD\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"30\",\r\n   \"rule-name\": \"30\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"LIST_UPLOAD_STATUS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"31\",\r\n   \"rule-name\": \"31\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"LISTS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"32\",\r\n   \"rule-name\": \"32\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"PROMPT_BOT\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"33\",\r\n   \"rule-name\": \"33\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"SOCIAL_CONTENT\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"34\",\r\n   \"rule-name\": \"34\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"TAG\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"35\",\r\n   \"rule-name\": \"35\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"TAGGING\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"36\",\r\n   \"rule-name\": \"36\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"UNSUB_SURVEY\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"37\",\r\n   \"rule-name\": \"37\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"USER_ACTIVITY\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"38\",\r\n   \"rule-name\": \"38\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"USER_SCORE_HISTORY\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"39\",\r\n   \"rule-name\": \"39\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"VIDEO_EMAIL_PROMPT\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"40\",\r\n   \"rule-name\": \"40\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"VIDEO_FORMATS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"41\",\r\n   \"rule-name\": \"41\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"VIDEO_VIEW\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"42\",\r\n   \"rule-name\": \"42\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"VIDEOS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"transformation\",\r\n   \"rule-id\": \"43\",\r\n   \"rule-name\": \"43\",\r\n   \"rule-target\": \"table\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"%\",\r\n    \"table-name\": \"%\"\r\n   },\r\n   \"rule-action\": \"convert-lowercase\"\r\n  },\r\n  {\r\n   \"rule-type\": \"transformation\",\r\n   \"rule-id\": \"44\",\r\n   \"rule-name\": \"44\",\r\n   \"rule-target\": \"column\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"%\",\r\n    \"table-name\": \"%\",\r\n    \"column-name\": \"%\"\r\n   },\r\n   \"rule-action\": \"convert-lowercase\"\r\n  }\r\n ]\r\n}"

  tags {
    Name = "test"
  }
  target_endpoint_arn = "${aws_dms_endpoint.chartest.endpoint_arn}"
}
resource "aws_dms_replication_task" "system" {
  #cdc_start_time            = 1484346880
  migration_type            = "full-load-and-cdc"
  replication_instance_arn  = "${aws_dms_replication_instance.oracle-migration.replication_instance_arn}"
  replication_task_id       = "system-task-tf"
  replication_task_settings = "{\r\n  \"TargetMetadata\": {\r\n    \"TargetSchema\": \"\",\r\n    \"SupportLobs\": true,\r\n    \"FullLobMode\": true,\r\n    \"LobChunkSize\": 64,\r\n    \"LimitedSizeLobMode\": false,\r\n    \"LobMaxSize\": 0,\r\n    \"LoadMaxFileSize\": 0,\r\n    \"ParallelLoadThreads\": 0,\r\n    \"ParallelLoadBufferSize\": 0,\r\n    \"BatchApplyEnabled\": false\r\n  },\r\n  \"FullLoadSettings\": {\r\n    \"TargetTablePrepMode\": \"DO_NOTHING\",\r\n    \"CreatePkAfterFullLoad\": false,\r\n    \"StopTaskCachedChangesApplied\": false,\r\n    \"StopTaskCachedChangesNotApplied\": false,\r\n    \"MaxFullLoadSubTasks\": 8,\r\n    \"TransactionConsistencyTimeout\": 600,\r\n    \"CommitRate\": 10000\r\n  },\r\n  \"Logging\": {\r\n    \"EnableLogging\": false,\r\n    \"LogComponents\": [\r\n      {\r\n        \"Id\": \"SOURCE_UNLOAD\",\r\n        \"Severity\": \"LOGGER_SEVERITY_DEFAULT\"\r\n      },\r\n      {\r\n        \"Id\": \"SOURCE_CAPTURE\",\r\n        \"Severity\": \"LOGGER_SEVERITY_DEFAULT\"\r\n      },\r\n      {\r\n        \"Id\": \"TARGET_LOAD\",\r\n        \"Severity\": \"LOGGER_SEVERITY_DEFAULT\"\r\n      },\r\n      {\r\n        \"Id\": \"TARGET_APPLY\",\r\n        \"Severity\": \"LOGGER_SEVERITY_DEFAULT\"\r\n      },\r\n      {\r\n        \"Id\": \"TASK_MANAGER\",\r\n        \"Severity\": \"LOGGER_SEVERITY_DEFAULT\"\r\n      }\r\n    ],\r\n    \"CloudWatchLogGroup\": null,\r\n    \"CloudWatchLogStream\": null\r\n  },\r\n  \"ControlTablesSettings\": {\r\n    \"historyTimeslotInMinutes\": 5,\r\n    \"ControlSchema\": \"\",\r\n    \"HistoryTimeslotInMinutes\": 5,\r\n    \"HistoryTableEnabled\": false,\r\n    \"SuspendedTablesTableEnabled\": false,\r\n    \"StatusTableEnabled\": false\r\n  },\r\n  \"StreamBufferSettings\": {\r\n    \"StreamBufferCount\": 3,\r\n    \"StreamBufferSizeInMB\": 8,\r\n    \"CtrlStreamBufferSizeInMB\": 5\r\n  },\r\n  \"ChangeProcessingDdlHandlingPolicy\": {\r\n    \"HandleSourceTableDropped\": true,\r\n    \"HandleSourceTableTruncated\": true,\r\n    \"HandleSourceTableAltered\": true\r\n  },\r\n  \"ErrorBehavior\": {\r\n    \"DataErrorPolicy\": \"LOG_ERROR\",\r\n    \"DataTruncationErrorPolicy\": \"LOG_ERROR\",\r\n    \"DataErrorEscalationPolicy\": \"SUSPEND_TABLE\",\r\n    \"DataErrorEscalationCount\": 0,\r\n    \"TableErrorPolicy\": \"SUSPEND_TABLE\",\r\n    \"TableErrorEscalationPolicy\": \"STOP_TASK\",\r\n    \"TableErrorEscalationCount\": 0,\r\n    \"RecoverableErrorCount\": -1,\r\n    \"RecoverableErrorInterval\": 5,\r\n    \"RecoverableErrorThrottling\": true,\r\n    \"RecoverableErrorThrottlingMax\": 1800,\r\n    \"ApplyErrorDeletePolicy\": \"IGNORE_RECORD\",\r\n    \"ApplyErrorInsertPolicy\": \"LOG_ERROR\",\r\n    \"ApplyErrorUpdatePolicy\": \"LOG_ERROR\",\r\n    \"ApplyErrorEscalationPolicy\": \"LOG_ERROR\",\r\n    \"ApplyErrorEscalationCount\": 0,\r\n    \"ApplyErrorFailOnTruncationDdl\": false,\r\n    \"FullLoadIgnoreConflicts\": true,\r\n    \"FailOnTransactionConsistencyBreached\": false,\r\n    \"FailOnNoTablesCaptured\": false\r\n  },\r\n  \"ChangeProcessingTuning\": {\r\n    \"BatchApplyPreserveTransaction\": true,\r\n    \"BatchApplyTimeoutMin\": 1,\r\n    \"BatchApplyTimeoutMax\": 30,\r\n    \"BatchApplyMemoryLimit\": 500,\r\n    \"BatchSplitSize\": 0,\r\n    \"MinTransactionSize\": 1000,\r\n    \"CommitTimeout\": 1,\r\n    \"MemoryLimitTotal\": 1024,\r\n    \"MemoryKeepTime\": 60,\r\n    \"StatementCacheSize\": 50\r\n  }\r\n}"
  source_endpoint_arn       = "${aws_dms_endpoint.system.endpoint_arn}"
  table_mappings            = "{\r\n \"rules\": [\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"1\",\r\n   \"rule-name\": \"1\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"ADMIN_NOTE\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"2\",\r\n   \"rule-name\": \"2\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"CLIENT_BILLING_INFO\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"3\",\r\n   \"rule-name\": \"3\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"CLIENT_CONTACT_INFO\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"4\",\r\n   \"rule-name\": \"4\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"CLIENT_GROUP_ASSET\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"5\",\r\n   \"rule-name\": \"5\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"CLIENT_GROUP_ASSOC\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"6\",\r\n   \"rule-name\": \"6\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"CLIENT_GROUP_BLAST\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"7\",\r\n   \"rule-name\": \"7\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"CLIENT_GROUP_INVITATION\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"8\",\r\n   \"rule-name\": \"8\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"CLIENT_GROUPS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"9\",\r\n   \"rule-name\": \"9\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"CLIENT_INTEGRATION\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"10\",\r\n   \"rule-name\": \"10\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"CLIENT_REFERRAL\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"11\",\r\n   \"rule-name\": \"11\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"CLIENT_TAGS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"12\",\r\n   \"rule-name\": \"12\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"CLIENTS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"13\",\r\n   \"rule-name\": \"13\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"COMPONENT_CLIENT_ADDON\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"14\",\r\n   \"rule-name\": \"14\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"COMPONENT_SUITE\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"15\",\r\n   \"rule-name\": \"15\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"COMPOSER_THEME\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"16\",\r\n   \"rule-name\": \"16\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"CURRICULUM\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"17\",\r\n   \"rule-name\": \"17\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"CURRICULUM_ITEM\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"18\",\r\n   \"rule-name\": \"18\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"CURRICULUM_ITEM_USER_PROGRESS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"19\",\r\n   \"rule-name\": \"19\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"PROMO_CODE\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"20\",\r\n   \"rule-name\": \"20\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"SECONDARY_SUBSCRIPTION\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"21\",\r\n   \"rule-name\": \"21\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"SUBSCRIPTION_LEVELS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"22\",\r\n   \"rule-name\": \"22\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"TEMPLATE\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"23\",\r\n   \"rule-name\": \"23\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"TEMPLATE_CLIENTS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"24\",\r\n   \"rule-name\": \"24\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"TEMPLATE_ORDER\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"25\",\r\n   \"rule-name\": \"25\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"TEMPLATE_TAG\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"26\",\r\n   \"rule-name\": \"26\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"TEMPLATE_TAGGED\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"27\",\r\n   \"rule-name\": \"27\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"USER_VERIFIED_EMAILS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"selection\",\r\n   \"rule-id\": \"28\",\r\n   \"rule-name\": \"28\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"PROD\",\r\n    \"table-name\": \"USERS\"\r\n   },\r\n   \"rule-action\": \"include\"\r\n  },\r\n  {\r\n   \"rule-type\": \"transformation\",\r\n   \"rule-id\": \"29\",\r\n   \"rule-name\": \"29\",\r\n   \"rule-target\": \"table\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"%\",\r\n    \"table-name\": \"%\"\r\n   },\r\n   \"rule-action\": \"convert-lowercase\"\r\n  },\r\n  {\r\n   \"rule-type\": \"transformation\",\r\n   \"rule-id\": \"30\",\r\n   \"rule-name\": \"30\",\r\n   \"rule-target\": \"column\",\r\n   \"object-locator\": {\r\n    \"schema-name\": \"%\",\r\n    \"table-name\": \"%\",\r\n    \"column-name\": \"%\"\r\n   },\r\n   \"rule-action\": \"convert-lowercase\"\r\n  }\r\n ]\r\n}"

  tags {
    Name = "test"
  }
  target_endpoint_arn = "${aws_dms_endpoint.chartest.endpoint_arn}"
}
